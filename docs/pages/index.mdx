import { Tab, Tabs } from 'nextra-theme-docs'
import { Grid } from '../components/Grid'
import { ListItem } from '../components/ListItem'
 
# ‚ñ†‚óè‚ñ† GraphDL - Graph Definition Language

GraphDL is a full-stack language for defining data models and the relationships between them.
It support the intuitive and natural expressiveness of a graph database, the flexibility
of the document database, and the constraints with foriegn keys and referential integrity 
of a relational database.  The format is YAML with embedded JavaScript/TypeScript & JSX/HTML, and 
supports URL-based imports to compose Graphs together, as well as import any ES6 JavaScript module.

## Examples

<Tabs items={['ToDos', 'Projects', 'SaaS', 'Analytics', 'Commerce', 'Automotive', 'Data', 'GraphDL']}>
<Tab>
```yaml filename="graphdl.yaml" copy
User:
 _id:   email
 _name: ${name} <${email}>
 _icon: üßë
 _sameAs: https://schema.org/Person
 name:  name
 email: email
 image: url
 posts: [Post.author]
 
Post:
 _id:         slugify(Title)
 _name:       title
 _icon:       üìã
 _sameAs:     https://schema.org/BlogPosting
 title:       name
 description: description
 tags:        [string]
 content:     articleBody
 createdAt:   dateCreated
 createdBy:   creator
 author:      User.Email
```
</Tab>
<Tab>
```yaml filename="graphdl.yaml" copy
_visibility: public

Country:
 _plural: Countries
 _source: https://json.fyi/countries.json
 _id:     cca2
 _name:   name.common
 _icon:   üåé
 borders: [Country.cca3]
 requests: [Request->cf.country]
 
Colo:
 _id:     iata
 _source: https://speed.cloudflare.com/locations
 _name:   ${iata} - ${city}, ${cca2->name.common}, ${region}
 _icon:   ‚òÅÔ∏è
 cca2:    Country.cca2
 region:  Continent._id
 iata:    Airport.iata
 requests: [Request->cf.colo]
 
Airport:
 _source: https://json.fyi/airports.json
 _id:     icao
 _icon:   ‚úàÔ∏è
 tz:      TimeZone._id
 country: Country.cca2
 
Request:
 _id:          ${headers.cf-ray}-${headers.cf-ray}
 _name:        ${method} ${url} ${ip} ${cf.city} ${cf.region} ${cf.country->name.common} ${cf.asOrganization}
 _icon:        üßë‚Äçüíª
 _visibility:  admin
 cf.colo:      Colo.iata
 cf.country:   Country.cca2
 coordinates:  GeoPoint(cf.latitude,cf.longitude)
 cf.timezone:  TimeZone._id
```
</Tab>
<Tab>
```yaml filename="graphdl.yaml" copy
_name:        Northwind
_seed:        https://json.fyi/northwind.json
_defaultId:   entityId
_constraints: true

Category:
 _name: ${categoryName} - ${description}

Customer:
 _name: companyName
 _icon: 
 
Employee:
 _name: ${firstname} ${lastname}, ${title}

EmployeeTerritory:
 _name: territoryCode
 employeeId: Employee
 territoryCode: Territory.territoryCode
 
OrderDetail:
 _name: ${quantity} ${productId->name}
 orderId:   Order
 productId: Product
 
Product:
 _name:      productName
 categoryId: Category
 supplierId: Supplier
 
SalesOrder:
 _name: ${date(orderDate)} - ${count(<-OrderDetail)} Items
 customerId: Customer
 employeeId: Employee
 shipperId:  Shipper

Shipper:
 _name: companyName
 
Supplier:
 _name: companyName
 
Region:
 _name: regiondescription
 
Territory:
 regionId: Region
```
</Tab>
<Tab>
```yaml filename="graphdl.yaml" copy
üßë Customer:
  has: [DeliveryAddress]
  places: [Order]
  liableFor: [Invoice]

üèòÔ∏è DeliveryAddress:
  receives: [Order]

üßæ Invoice:
  covers: [Order]

üí∏ Order:
  includes: [OrderItem]

üö• ProductCategory:
  contains: [Product]

üì¶ Product:
  orderedIn: [OrderItem]
```
</Tab>
<Tab>
```yaml filename="graphdl.yaml" copy
import: Vehicle from https://graphdl.org/Providers/Drivly

üöò Vehicle:
  allows: [NamedDriver]
  registrationNumber: string
  make: string
  model: string

üßë Person:
  is: [NamedDriver]
  firstName: string
  lastName: string
  age: integer
```
</Tab>
<Tab>
```yaml filename="graphdl.yaml" copy
```
</Tab>
</Tabs>

JavaScript code is a native part of GraphDL, and GraphDL Schema is transpiled into a 
[JavaScript Module](/nouns) with full [TypeScript](/nouns) support. 
[JSON Schema](/nouns), [OpenAPI](/nouns), [GraphQL](/nouns), a [Website](/nouns), 
a [React Admin App](/nouns), and [Documentation](/nouns) can also be optionally generated.

<Tabs items={['GraphDL', 'TypeScript', 'JavaScript', 'API', 'JSON Schema', 'GraphQL', 'Website', 'App', 'App']}>
  <Tab>
```yaml filename="graphdl.yaml" copy
‚úÖ ToDo:
    title:       string!
    description: string
    status:      To Do | In Progress | Blocked | Done = To Do
    subtasks:    [ToDo->partOf]
    partOf:      ToDo.subtasks
    assignedTo:  User.assigned = createdBy()
    createdBy:   User.created = createdBy()

üßë‚Äçüíª User:
    _sameAs:     https://schema.org/Person
    name:        string
    email:       email!
    assigned:    [ToDo->assignedTo]
    created:     [ToDo->createdBy]
```
  </Tab>
  <Tab>
```typescript filename="types.ts" copy
// Generated by GraphDL (https://graphdl.org)
// https://registry.graphdl.org/examples@0.1.0/types.ts

import types { DB, Graph, Noun } from 'https://pkg.do/graphdl.js'

export type ToDo = Noun<ToDo> & {
  title:  string
  description?: string
  status: 'To Do' | 'In Progress' | 'Blocked' | 'Done'
  subtasks: Promise ToDo[]
  partOf: ToDo
  assignedTo: User
  createdBy: User
}

export type User = Noun<ToDo> & {
  name: string
  email: string
  toDos: ToDo[]
  created: ToDo[]
}

export type Graph = Graph & {
  nouns: {
    ToDo: ToDo
    User: User
  }
}

```
  </Tab>
  <Tab>
```javascript filename="sdk.js" copy
// Generated by GraphDL (https://graphdl.org)
// https://registry.graphdl.org/examples@0.1.0/index.js

import { SDK } from 'https://pkg.do/sdk.do'


```
  </Tab>
  <Tab>
```javascript filename="api.js" copy
// Generated by GraphDL (https://graphdl.org)
// https://registry.graphdl.org/examples@0.1.0/api.js

import { API, DB, enrichContext, errorHandling, json } from 'https://pkg.do/apis.do'
import todos from 'https://registry.graphdl.org/examples/todos.js'

const api = new API(todos, { basePath: '/api' })
const db = new DB(todos)

const { gettingStarted, examples } = todos

api.any('*', errorHandling, enrichContext)
api.get('/', (params, ctx) => json({ api, gettingStarted, examples, ...ctx }))
api.get('/login', api.login)
api.get('/logout', api.logout)
api.any('*', api.assertLoggedIn)
api.get('/todos', db.todos.search)
api.post('/todos', db.todos.create)
api.get('/todos/:id', db.todos.get)
api.post('/todos/:id', db.todos.create)
api.patch('/todos/:id', db.todos.upsert)
api.put('/todos/:id', db.todos.update)
api.delete('/todos/:id', db.todos.delete)
api.get('/user', db.users.search)
api.any('*', (params, ctx) => json({ api, status: 404, error: 'Not Found', gettingStarted, examples, ...ctx })))
```
  </Tab>
  <Tab>
```json filename="https://registry.graphdl.org/examples@0.1.0/schema.json" copy
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://"
}
```
  </Tab>
  <Tab>
```yaml filename="saas.graphdl" copy
```
  </Tab>
  <Tab>
```yaml filename="saas.graphdl" copy
```
  </Tab>
</Tabs>

The generated [Javascript](/#) and [Typescript](/#) code includes the base data models, as well as [Validation](/#) logic, 
[List](/#), [Search](/#), [Create](/#), [Update](/#), & [Delete](/#) logic for client and/or server side use, including APIs, 

That can be deployed anywhere including [Cloudflare Workers](/#), [Deno Deploy](/#), [Fly.io](/#), [AWS](/#), [Azure](/#), [GCP](/#)
or with self-hosted containers



Nouns are the things in a [Graph](/Nouns/Graph).  Every [Noun](/Nouns/Noun)
has [Properties](/Properties) that describe its attributes.
[Nouns](/Nouns/Noun) relate to each other through [Verbs](/Verbs).
[Triggers](/Triggers) are the potential [Events](/Events) that can
happen to a [Noun](/Nouns/Noun). A [Resource](/Nouns/Resource) is a specific
instance of a [Noun](/Nouns/Noun), and an [Action](/Nouns/Action) is a
specific instance of a [Verb](/Verbs) relating to specific instances of
[Nouns](/Nouns), and an [Event](/Nouns/Event) is an instance of a 
[Trigger](/Nouns/Trigger).

<Grid>
  <ListItem icon='‚ñ†‚óè' name='Graph'/>
  <ListItem icon='‚ñ†' name='Noun'/>
  <ListItem icon='‚óè' name='Verb'/>
  <ListItem icon='‚óÜ' name='Trigger'/> 
  <ListItem icon='‚à∑' name='Property'/>
  <ListItem icon='‚ñ°' name='Resource'/>
  <ListItem icon='‚óã' name='Action'/>
  <ListItem icon='‚óá' name='Event'/>
  {/* <ListItem icon='‚ßÜ' name='Query'/>
  <ListItem icon='‚äõ' name='Search'/> */}
  <ListItem icon='ÂÖ•' name='API'/>
  <ListItem icon='‚ù¥‚ùµ' name='Data'/>
  <ListItem icon='‚ù™‚ù´' name='Function'/>
  <ListItem icon='‚ùÆ‚ùØ' name='UI'/>
  <ListItem icon='‚ñº' name='Role'/>
  <ListItem icon='‚ò∂' name='Site'/>
  <ListItem icon='‚ßâ' name='App'/>
  <ListItem icon='‚ò±' name='Docs'/>
  <ListItem icon='‚ñΩ' name='User'/>
  <ListItem icon='‚ñ≥' name='Tenant'/>
  <ListItem icon='‚ü¢' name='Request'/>
  <ListItem icon='‚ü£' name='Response'/>
</Grid>

## ‚ñ†‚óè Graph

A [Graph](/#Graph) is a collection of [Nouns](/#Noun) and [Verbs](/#Verb) that describe the relationships between [Nouns](/#Noun).

## ‚ñ† Noun

A [Noun](/#Noun) is a person, place, thing, or idea and has [Properties](/#Properties) that describe it.

```yaml
Customer
  name: string
  email: email
  phone: phone
  notes: markdown
```

## ‚ñ° Resource

A [Resource](/nouns/resource) is a specific instance of a [Noun](/nouns/noun) and can be stored or
transmitted in JSON as [Data](/nouns/data)

For example, in `User/john` the [Resource](/nouns/resource) is `john` and the [Noun](/nouns/noun) is `User`.

```json
{
  "_type": "User",
  "_id": "john",
  "name": "John Doe",
  "email": "john@example.com"
}
```

## ‚à∑ Property

A [Property](/Properties/Property) are the attributes that describe a [Noun](/nouns/noun) or [Verb](/verbs/verb). 
[Properties](/nouns/properties) that start with and underscore (`_`) like [`_type`](/properties/_type), 
[`_sameAs`](/properties/_sameAs), or [`_icon`](/properties/_icon) or mean that they are internal properties that
that describe the [Noun](/nouns/noun) or [Verb](/verbs/verb) and cannot be changed on any given 
[Resource](/nouns/resource) with the exception of `_id` which must be unique for every [Resource](/nouns/resource).

## ‚óè Verb

A [Verb](/verbs/verb) connects a [Noun](/nouns/noun) to a different [Noun](/#Noun), and is expressed as `[Subject].[Verb]: [Object]`.

For example, in `User.subscribes: App` the verb `subscribes` connects the [Subject](/#) `User` to the [Object](/#) `App`.

## ‚óã Action

An [Action] happens when an instance of a [Noun] (i.e. [Resource]) does a [Verb] to a different [Resource].

For example, in `User/john.subscribes: App/ToDos` the verb `subscribes` connects the [Subject Resource] `User/john` to the [Object Resource] `App/ToDos`.

## ‚óÜ Trigger

A [Trigger] invokes an [Action] on a [Schedule], when a [Resource] is created, modified, or deleted, or when an [Action] happens.

## ‚óá Event

An [Event] happens whenever a [Trigger] happening at a specific point in time, and can occur at scheduled times, whenever a [Resource] is created, updated, or deleted, or whenever an [Action] happens.

## ‚ßÜ Query

A [Query] is the input criteria for a [Search] in a [Graph] that may or may not be constrained to a specific [Noun] or [Verb]

## ‚äõ Search

A [Search] is as [Action] that returns a list of [Resources] that match a specific [Query].

## ÂÖ• API

An [API] is a [Function] that can be passed [Data] via a [Request] and returns [Data] in a [Response].

## ‚¨Æ Integration

An [Integration] connects a [Graph] to a third-party [Provider] and can be used with [Triggers], [Searches], and [Actions] data.

## ‚¨Ø Provider

A [Provider] is a third-party service that can be connected to a [Graph] via an [Integration].

## ‚ù¥‚ùµ Data

[Data] is the information that is stored in a [Resource] in a JSON format.

## ‚ù™‚ù´ Function

A [Function] is Javascript code that can be placed on a [Verb] is executed when an [Action] happens.

## ‚ùÆ‚ùØ UI

A [UI] is JSX code that can be placed on a [Noun] and is executed when a [Resource] is rendered.

## ‚ò∂ Site

A [Site] is a publicly-accesible [UI] and can be deployed to the cloud, and run in the cloud, at the edge, or in a browser

## ‚ßâ App

An [App] is an composition of [UI] powered by [APIs] with [Users] and [Tenants], and that can be deployed to the cloud, and run in the cloud, at the edge, in a browser, or on a device.

## ‚ò± Docs

[Docs] are the documentation for a [Graph]'s [Nouns], [Verbs], [API] and [App] that can be deployed to the cloud to be viewed in a browser.

## ‚ñº Role

A [Role] describes the relationship between a [User] and a [Tenant] with specific [Permissions] relating to [Resources] and [Actions] on a [Graph].

## ‚ñΩ User

A [User] is a person who has a [Role] in a [Tenant] and can access [Resources] and perform [Actions] in a [Graph].

## ‚ñ≥ Tenant

A [Tenant] is a business or organization that has a [Role] in a [Graph] and can access [Resources] and perform [Actions] in a [Graph].
